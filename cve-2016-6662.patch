@@ -264,6 +264,19 @@
   lib_to_add="$1"
   log_notice "Adding '$lib_to_add' to LD_PRELOAD for mysqld"
 
+  # Check if the library is in the standard system directories
+  case "$(dirname "$malloc_lib")" in
+    /usr/lib) ;;
+    /usr/lib64) ;;
+    /usr/lib/i386-linux-gnu) ;;
+    /usr/lib/x86_64-linux-gnu) ;;
+    ${MY_BASEDIR_VERSION}/lib) ;;
+    *)
+      log_error "--malloc-lib must be located in one of the system directories ((/usr/lib64, /usr/lib, /usr/lib/i386-linux-gnu, /usr/lib/x86_64-linux-gnu, ${MY_BASEDIR_VERSION}/lib)"
+      exit 1
+      ;;
+  esac
+
   case "$lib_to_add" in
     *' '*)
       # Must strip path from lib, and add it to LD_LIBRARY_PATH
